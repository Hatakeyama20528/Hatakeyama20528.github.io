# DirectX フレームワーク

今年の進級制作展（就活）作品を制作するためのフレームワークとして準備している作品になります。

描画まわりについてこだわりたいと思っているので、実現できるように**ディファードレンダリング**、**頂点圧縮**、を実装しています。

## 圧縮プログラムのダウンロード

頂点圧縮のサンプルプログラムは下記よりダウンロードできます：

[Google Drive（圧縮プログラム配布）](https://drive.google.com/drive/folders/1KpQY3D3uRsKXaaPuWcbWdjbdqgczFl_o?usp=drive_link)

## 頂点圧縮について

下記の画像で使用しているモデルの頂点数は 9036個、一個当たり38バイトで合計約335.3KBとなります。

圧縮後の頂点は一個当たり20バイトで合計約176.4KBまで圧縮できています。

![頂点圧縮モデル](images/ConpModel.png)

## 頂点のレイアウトについて

![頂点レイアウト](images/Layout.png)

## 圧縮方式について

法線についてはOctahedronEncoding（[参考サイト](https://knarkowicz.wordpress.com/2014/04/16/octahedron-normal-vector-encoding/)）を使用しており、もとの12バイトから4バイトまで圧縮を成功しています。

![圧縮方式1](images/Normal1.png)
![圧縮方式2](images/Normal2.png)

## 画像処理について

ガウシアンフィルタ、ソーベルフィルタ、シンプレックスノイズをテストしています。

![画像処理テスト](images/TextureTest.png)

## シェーダーについて

### 1. 法線デコード処理

頂点圧縮で格納した法線ベクトルをデコードするシェーダーコード例です。16bit整数から-1〜1の範囲に変換し、八面体マッピングで復元しています。

![法線デコードシェーダー](images/Decode.png)

### 2. ディファードレンダリング用Gバッファ書き出し

Gバッファへの書き出しを行うピクセルシェーダーの一部です。アルベド、深度、法線、マテリアル情報をそれぞれのターゲットに出力しています。

![Gバッファ書き出しシェーダー](images/GBuff.png)

### 3. こだわったマテリアル表現

PBR（物理ベースレンダリング）を意識し作成しました、追加でアウトラインを表示しています、簡易実装として使用した方法は背面法で、現在ソーベルフィルタを使った輪郭検出を作成しています。

下記は実際のマテリアル計算部分のシェーダーコード例です。

![マテリアルシェーダー1](images/PBR_PS.png)
![マテリアルシェーダー2](images/PBR_Render.png)
![追加マテリアル画像](images/NewMaterial.png)

## 雨粒のポストプロセス

（内容を追加予定）
