# Shadow Collision

グループでコンテストでの受賞を目指して制作している作品になります。

光と影のギミックをテーマにした **2Dパズルアクションゲーム** です。プレイヤーは光源を操作して影の形を変化させ、道を作りながらゴールを目指します。

---

## ゲームコンセプト

### コアメカニクス

- **光源操作**: 光の位置と角度を調整
- **影の変形**: オブジェクトの影を利用した足場作り
- **2D/3D切り替え**: フェーズごとに視点が変わる独特のゲームプレイ

---

## ターンの切り替え

このゲームには主に2つのフェーズがありそれぞれ **2D**、**3D** で別れているのでそれの切り替え処理になります。

切り替えにはイージングを付けたり、切り替え時に背景に被写界深度を使ってぼかしを付けたり、細かいところを気を付けています。

### 実装した技術

- **イージング関数**: スムーズなカメラ遷移
- **被写界深度（DoF）**: フォーカス外のボケ表現
- **カメラワーク**: 2Dと3D視点の自然な切り替え

![ターン切り替え 1](images/Turn1.png)

[video:videos/Turn2.mp4]

---

### フェーズシステムの詳細

#### フェーズ1：配置フェーズ（3D）

- オブジェクトを自由に配置
- 光源の位置を調整
- 影の投影をプレビュー

#### フェーズ2：プレイフェーズ（2D）

- 生成された影の上を移動
- パズル要素を解く
- ゴールを目指す

---

## ゴール演出

画像の輪郭を検出して切り出し、そのアウトラインを指定色に変更できるようにしてあり、そこにブルームを焚くことで作成しています。

輪郭検出アルゴリズムには **ソーベルフィルター** を採用しており、これを応用して現在の影の当たり判定にも応用しています。

### ソーベルフィルターの活用

#### 1. 輪郭検出

```
カーネル:
[-1  0  1]    [-1 -2 -1]
[-2  0  2]  +  [ 0  0  0]
[-1  0  1]    [ 1  2  1]
```

#### 2. 応用例

- **ゴールエフェクト**: アウトライン強調とグロー効果
- **影の当たり判定**: 影の境界を正確に検出
- **ビジュアルエフェクト**: セルシェーディング風の表現

![ゴール演出 1](images/Goal1.png)
![ゴール演出 2](images/Goal2.png)

---

## オブジェクトの配置

前述のとおり、フェーズが分かれているのですが、最初のタイミングで画面上にあるオブジェクトを好きな場所に配置できます。

配置に伴い操作周りも作成しました。

### オブジェクト操作システム

#### 実装した機能

- **グリッドスナップ**: オブジェクトを格子状に配置
- **回転機能**: オブジェクトの向きを調整
- **プレビュー**: 影の投影をリアルタイムで確認

#### 操作方法

- **選択**: クリックまたはタップ
- **移動**: ドラッグ&ドロップ
- **回転**: 右クリックまたはボタン
- **配置確定**: エンターキーまたは決定ボタン

![オブジェクト配置 1](images/Grap1.png)
![オブジェクト配置 2](images/Grap2.png)

---

## 技術的な詳細

### シェーダー実装

#### 1. リアルタイムシャドウマッピング

- **シャドウマップ解像度**: 2048x2048
- **ソフトシャドウ**: PCF（Percentage Closer Filtering）
- **バイアス調整**: シャドウアクネ対策

#### 2. ポストプロセス

- **ブルーム**: 光の滲み表現
- **カラーグレーディング**: 雰囲気作り
- **ビネット**: 画面四隅の暗化

---

### 物理演算

#### 影の当たり判定

- **2Dポリゴン生成**: 影の形状を2D平面に投影
- **衝突検出**: SAT（分離軸定理）を使用
- **物理応答**: キャラクターの移動制約

---

## 開発環境

### 使用ツール

- **エンジン**: Unity 2022.3.61
- **言語**: C#
- **シェーダー**: HLSL (Shader Graph)
- **バージョン管理**: Git

### チーム構成

- **プログラマー**: 2名（物理・シェーダー担当）
- **デザイナー**: 2名（UI・レベルデザイン担当）
- **サウンド**: 1名

---

## 今後の開発予定

### 追加機能

- [ ] ステージエディタ機能
- [ ] チュートリアルの充実
- [ ] ストーリーモードの追加
- [ ] マルチプレイヤー対応（協力モード）

### 最適化

- [ ] シャドウマップの動的解像度調整
- [ ] ロード時間の短縮
- [ ] メモリ使用量の削減

---

## コンテストへの挑戦

本作品は、以下のコンテストへの出展を予定しています：

- **ゲームコンテスト**: 学生向けゲーム開発コンテスト
- **インディーゲームフェスティバル**: 展示と試遊会
- **技術デモ**: ゲーム開発カンファレンス

---
